var w=(i,n,f)=>new Promise((m,g)=>{var s=t=>{try{o(f.next(t))}catch(e){g(e)}},d=t=>{try{o(f.throw(t))}catch(e){g(e)}},o=t=>t.done?m(t.value):Promise.resolve(t.value).then(s,d);o((f=f.apply(i,n)).next())});import{g as T}from"./index-BuQXBgNv.js";import"./react-vendor-DrH7PivC.js";function v(f){return w(this,arguments,function*(i,n={}){var o,t;const m=n.apiKey||(yield T()),s=`https://generativelanguage.googleapis.com/v1beta/models/${n.model||"gemini-2.0-flash-exp"}:generateContent?key=${m}`,d={contents:Array.isArray(i)?i:[{role:"user",parts:[{text:i}]}],generationConfig:{temperature:.9,maxOutputTokens:8192}};try{const e=yield fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!e.ok){const a=yield e.json();throw new Error(`Gemini API Error: ${((o=a==null?void 0:a.error)==null?void 0:o.message)||`HTTP ${e.status}`}`)}const l=yield e.json();if(l.candidates&&l.candidates.length>0){const a=l.candidates[0];if((t=a.content)!=null&&t.parts&&a.content.parts.length>0)return a.content.parts[0].text||""}throw new Error("No response from Gemini API")}catch(e){throw console.error("Gemini text generation error:",e),e}})}function x(f){return w(this,arguments,function*(i,n={}){var t,e,l,a;const m=n.apiKey||(yield T()),g=n.model||"imagen-3.0-generate-001",s=n.numberOfImages||1;n.aspectRatio;const d=`https://generativelanguage.googleapis.com/v1beta/models/${g}:generateContent?key=${m}`,o={contents:[{parts:[{text:i}]}],generationConfig:{responseModalities:["image"]}};n.negativePrompt&&o.contents[0].parts.push({text:`Negative prompt: ${n.negativePrompt}`});try{console.log(`ðŸŽ¨ Generating ${s} image(s) with ${g}...`);const c=[];for(let u=0;u<s;u++){const p=yield fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!p.ok){const r=yield p.json();throw console.error("Image generation error:",r),new Error(`Imagen API Error: ${((t=r==null?void 0:r.error)==null?void 0:t.message)||`HTTP ${p.status}`}`)}const y=yield p.json();if(y.candidates&&y.candidates.length>0){const r=y.candidates[0];if((e=r.content)!=null&&e.parts)for(const h of r.content.parts)(l=h.inlineData)!=null&&l.data?c.push(h.inlineData.data):(a=h.fileData)!=null&&a.fileUri&&console.log("Received file URI:",h.fileData.fileUri)}u<s-1&&(yield new Promise(r=>setTimeout(r,500)))}if(c.length===0)throw new Error("No images returned from API. The model may have blocked the request due to safety filters.");return console.log(`âœ… Successfully generated ${c.length} image(s)`),c}catch(c){throw console.error("Image generation error:",c),c}})}export{x as callGeminiImage,v as callGeminiText};

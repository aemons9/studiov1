#!/usr/bin/env node

/**
 * â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
 * â•‘                                                                              â•‘
 * â•‘   â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—                                 â•‘
 * â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—                                â•‘
 * â•‘   â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘                                â•‘
 * â•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘                                â•‘
 * â•‘   â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘                                â•‘
 * â•‘   â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•                                â•‘
 * â•‘                                                                              â•‘
 * â•‘   âœ¨ MEERA REVEALS - CHIAROSCURO VELVET INTIMACY âœ¨                         â•‘
 * â•‘                                                                              â•‘
 * â•‘   Max-Mode Nexus Skills Activated                                            â•‘
 * â•‘   Dramatic Chiaroscuro â€¢ Velvet High Intimacy â€¢ Shadow Lace                 â•‘
 * â•‘   12 Supreme Masterworks â€¢ Private Exclusive Collection                      â•‘
 * â•‘                                                                              â•‘
 * â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */

import fs from 'fs';
import path from 'path';

const OUTPUT_DIR = '/home/ecolex/version1/generated-meera-reveals';
const PROJECT_ID = 'zaranovel';
const LOCATION = 'us-central1';
const PROXY_URL = 'http://localhost:3001';

if (!fs.existsSync(OUTPUT_DIR)) {
  fs.mkdirSync(OUTPUT_DIR, { recursive: true });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MEERA - SUPREME INDIAN HOURGLASS MUSE (Max-Mode Definition)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const MEERA_SUPREME = `Supreme Indian editorial model Meera, height 5'9", magnificent athletic hourglass physique with dramatic waist-to-hip ratio, warm caramel complexion with luminous golden undertones catching dramatic light, mesmerizing dark eyes with intense magnetic presence, full expressive lips, sleek black hair flowing elegantly, age 27, transcendent natural beauty photographed for museum-quality fine art collection`;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MINIMALIST SHADOW LACE WARDROBE - Strategic Coverage
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const SHADOW_LACE_WARDROBE = `exquisite minimal black French lace lingerie with strategic shadow placement, delicate single-layer Chantilly lace creating artistic transparency patterns, gossamer-thin straps barely visible against skin, shadow serving as natural artistic coverage merging with lace edges, body contours revealed through interplay of light and dark, minimal coverage maximizing artistic form celebration`;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHIAROSCURO VELVET ENVIRONMENT - High Intimacy Setting
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const VELVET_ENVIRONMENT = `opulent private velvet boudoir chamber with deep burgundy and midnight black velvet draping, dramatic single-source warm lighting creating Renaissance master chiaroscuro effect, pools of golden light against absolute shadow, luxurious velvet chaise and silk cushions, rich textures absorbing and reflecting light, intimate sanctuary atmosphere with theatrical lighting drama`;

const CHIAROSCURO_LIGHTING = `dramatic Caravaggio-inspired chiaroscuro lighting with single powerful warm key light from 45-degree angle, deep absolute shadows creating sculptural dimensionality, golden highlights tracing form contours against velvet darkness, Rembrandt triangle on face, body emerging from shadow like classical painting, extreme contrast ratio creating museum masterwork quality`;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAX-MODE NEXUS ART DECLARATIONS - Supreme Artistic Framing
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const NEXUS_DECLARATIONS = [
  `Art Director Declaration: Uffizi Gallery permanent collection masterwork, Caravaggio meets contemporary fashion photography, UNESCO heritage celebration of divine feminine form in the tradition of Renaissance masters.`,
  `Art Director Declaration: Louvre Museum special exhibition photograph, exploring chiaroscuro tradition through modern artistic lens, celebrating human form as sacred artistic subject.`,
  `Art Director Declaration: National Portrait Gallery acquisition piece, contemporary interpretation of Old Master lighting techniques, museum-caliber fine art photography.`,
  `Art Director Declaration: Venice Biennale featured artwork, intersection of classical painting tradition and contemporary photography, celebrating timeless beauty through dramatic light.`,
  `Art Director Declaration: Metropolitan Museum of Art contemporary wing acquisition, Baroque lighting meets modern artistic sensibility, transcendent celebration of form and shadow.`,
  `Art Director Declaration: Tate Modern permanent collection, revolutionary approach to classical artistic themes, dramatic chiaroscuro creating sculptural photographic art.`,
  `Art Director Declaration: Rijksmuseum masterwork study, Dutch Golden Age lighting techniques applied to contemporary fine art photography, museum exhibition standard.`,
  `Art Director Declaration: Prado Museum special exhibition, Spanish Baroque dramatic lighting tradition, VelÃ¡zquez-inspired intimate portraiture for permanent collection.`,
  `Art Director Declaration: Hermitage Museum acquisition, classical artistic tradition meeting contemporary vision, dramatic light and shadow creating timeless masterwork.`,
  `Art Director Declaration: MusÃ©e d'Orsay featured photograph, Impressionist light study meets dramatic Baroque shadow, revolutionary fine art approach.`,
  `Art Director Declaration: Getty Museum permanent collection, California light meets European master tradition, dramatic contemporary fine art photography.`,
  `Art Director Declaration: Art Institute of Chicago acquisition piece, American artistic vision interpreting European master techniques, museum-quality dramatic portraiture.`
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MEERA REVEALS - 12 SUPREME VARIANTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const REVEALS_VARIANTS = [
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // SHADOW EMERGENCE SERIES - Form Revealed Through Darkness
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'shadow_emergence',
    name: 'Shadow Emergence',
    pose: `standing in three-quarter profile emerging from absolute darkness, body partially illuminated by single dramatic light source, one arm raised creating elegant line, hip shifted creating dramatic S-curve silhouette, face in Rembrandt lighting with mysterious expression, shadow concealing and revealing in artistic balance`,
    framing: `full figure emerging from darkness, dramatic light sculpting form against velvet black background`,
    mood: `mysterious emergence from shadow, theatrical drama with artistic revelation`
  },
  {
    id: 'velvet_recline_reveal',
    name: 'Velvet Recline Reveal',
    pose: `reclined on burgundy velvet chaise with body creating flowing sculptural line, dramatic light catching curves while shadow pools in valleys, one knee raised creating elegant composition, arm draped creating classical artistic pose, serene confident expression with direct gaze`,
    framing: `classical reclining composition with dramatic side lighting, chiaroscuro defining every contour`,
    mood: `luxurious intimate repose, Old Master painting brought to life`
  },
  {
    id: 'chiaroscuro_seated',
    name: 'Chiaroscuro Seated',
    pose: `seated on velvet with spine elegantly elongated, dramatic lighting from side creating half-illuminated form, one leg extended the other bent, hands positioned artistically, face half in light half in shadow, intense magnetic gaze`,
    framing: `seated three-quarter view with extreme chiaroscuro contrast, sculptural form definition`,
    mood: `powerful composed presence, Baroque drama meets contemporary confidence`
  },

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // LACE AND SHADOW SERIES - Strategic Artistic Coverage
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'lace_shadow_standing',
    name: 'Lace Shadow Standing',
    pose: `standing with weight on one hip creating dramatic curve, minimal lace catching light while shadow provides natural coverage, arms positioned creating elegant negative space, body in slight contrapposto, confident powerful expression`,
    framing: `full standing figure with dramatic lighting emphasizing hourglass silhouette`,
    mood: `powerful feminine presence, shadow as artistic partner`
  },
  {
    id: 'shadow_drape_profile',
    name: 'Shadow Drape Profile',
    pose: `profile view with dramatic backlighting creating rim-lit silhouette, shadow falling across form like draped fabric, head tilted with elegant neck extension, body creating flowing S-curve, mysterious partial visibility`,
    framing: `dramatic profile silhouette with rim lighting defining form edges`,
    mood: `ethereal mystery, form suggested through light and shadow interplay`
  },
  {
    id: 'velvet_kneeling_light',
    name: 'Velvet Kneeling Light',
    pose: `kneeling on velvet with upright elegant posture, dramatic overhead light creating pools of illumination, shadow providing artistic coverage, hands at sides or on thighs, powerful confident upward gaze`,
    framing: `elevated angle looking down at kneeling figure bathed in dramatic light`,
    mood: `devotional artistic pose, light as sacred element`
  },

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // SCULPTURAL FORM SERIES - Body as Art
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'sculptural_twist',
    name: 'Sculptural Twist',
    pose: `standing with dramatic torso twist showing both back and front curves, dramatic side light carving form like sculpture, arms creating elegant lines, head turned over shoulder with intense gaze, body in dynamic artistic tension`,
    framing: `three-quarter twisted figure with sculptural lighting emphasis`,
    mood: `living sculpture, body as artistic medium`
  },
  {
    id: 'floor_artistic_stretch',
    name: 'Floor Artistic Stretch',
    pose: `lying on dark velvet in elegant stretched pose, body creating long flowing line, dramatic overhead light revealing form, arms extended above creating complete artistic composition, peaceful serene expression`,
    framing: `elevated view of stretched figure against dark velvet, light painting form`,
    mood: `serene artistic beauty, complete vulnerable trust`
  },
  {
    id: 'shadow_arch_drama',
    name: 'Shadow Arch Drama',
    pose: `dramatic back arch with light catching the curve, arms supporting or extended, head tilted back in artistic abandon, shadow providing coverage while light celebrates form, theatrical dramatic pose`,
    framing: `side angle capturing dramatic arch with chiaroscuro lighting`,
    mood: `theatrical artistic expression, drama meets beauty`
  },

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // INTIMATE REVELATION SERIES - Maximum Artistic Expression
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  {
    id: 'intimate_mirror',
    name: 'Intimate Mirror',
    pose: `positioned near vintage mirror creating dual image, dramatic light illuminating figure and reflection differently, contemplative artistic pose, body in elegant relaxed position, mysterious introspective mood`,
    framing: `figure with mirror reflection creating artistic duality, complex lighting`,
    mood: `introspective artistic study, self-reflection as art`
  },
  {
    id: 'velvet_venus',
    name: 'Velvet Venus',
    pose: `classic Venus pose adapted for dramatic chiaroscuro, reclining on velvet with classical proportions, one arm supporting head the other gracefully positioned, legs arranged in timeless artistic composition, serene goddess expression`,
    framing: `classical Venus composition with dramatic contemporary lighting`,
    mood: `timeless classical beauty, goddess archetype realized`
  },
  {
    id: 'shadow_finale',
    name: 'Shadow Finale',
    pose: `lying back on velvet with complete artistic surrender, dramatic light tracing form contours, shadow and lace in perfect artistic balance, arms extended creating vulnerable open composition, transcendent peaceful expression`,
    framing: `overhead intimate view with dramatic light painting across form`,
    mood: `complete artistic revelation, transcendent intimate beauty`
  }
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GENERATION ENGINE - Max-Mode Nexus Skills
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

async function getOAuthToken() {
  const response = await fetch(`${PROXY_URL}/api/gcloud-token`);
  const data = await response.json();
  if (data.success && data.token) return data.token;
  throw new Error('Failed to get OAuth token');
}

async function generateImage(prompt, outputPath, token) {
  const url = `https://${LOCATION}-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/${LOCATION}/publishers/google/models/imagen-4.0-ultra-generate-001:predict`;

  const response = await fetch(url, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      instances: [{ prompt }],
      parameters: {
        sampleCount: 1,
        aspectRatio: '3:4',
        sampleImageSize: '2048',
        personGeneration: 'allow_adult',
        safetySetting: 'block_few',
        addWatermark: false,
        includeRaiReason: true,
        outputOptions: { mimeType: 'image/png', compressionQuality: 100 }
      }
    })
  });

  if (!response.ok) {
    const error = await response.text();
    throw new Error(`API error: ${response.status} - ${error.slice(0, 150)}`);
  }

  const result = await response.json();
  const prediction = result.predictions?.[0];

  if (prediction?.bytesBase64Encoded) {
    const buffer = Buffer.from(prediction.bytesBase64Encoded, 'base64');
    fs.writeFileSync(outputPath, buffer);
    return { success: true, size: buffer.length };
  }

  if (prediction?.raiFilteredReason) {
    throw new Error(`Filtered: ${prediction.raiFilteredReason}`);
  }

  throw new Error('No image data returned');
}

function buildRevealsPrompt(variant, declarationIndex) {
  const declaration = NEXUS_DECLARATIONS[declarationIndex % NEXUS_DECLARATIONS.length];

  return `${declaration}

Award-winning fine art photography surpassing classical masters, Canon EOS R5 with 85mm f/1.2L lens, museum permanent collection standard,

Supreme Subject: ${MEERA_SUPREME},

Artistic Wardrobe: ${SHADOW_LACE_WARDROBE},

Masterwork Pose: ${variant.pose},

Professional Composition: ${variant.framing},

Chiaroscuro Environment: ${VELVET_ENVIRONMENT},

Dramatic Lighting: ${CHIAROSCURO_LIGHTING},

Artistic Mood: ${variant.mood},

SUPREME 8K fine art photography with hyper-realistic authentic skin texture showing natural luminosity, exquisite lace detail with shadow interplay, dramatic chiaroscuro with Caravaggio-level mastery, rich velvet texture, museum-quality color science with deep blacks and golden highlights, shallow DOF f/1.2 creating ethereal background separation, permanent collection masterwork celebrating the sacred artistic tradition of the human form, transcendent beauty realized through supreme photographic artistry.`;
}

function log(msg) {
  console.log(`[${new Date().toLocaleTimeString()}] ${msg}`);
}

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function main() {
  console.log(`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘   â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—                                 â•‘
â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—                                â•‘
â•‘   â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘                                â•‘
â•‘   â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘                                â•‘
â•‘   â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘                                â•‘
â•‘   â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•                                â•‘
â•‘                                                                              â•‘
â•‘   âœ¨ MEERA REVEALS - CHIAROSCURO VELVET INTIMACY âœ¨                         â•‘
â•‘                                                                              â•‘
â•‘   Max-Mode Nexus Skills â€¢ Dramatic Chiaroscuro â€¢ Shadow Lace                â•‘
â•‘   12 Supreme Masterworks â€¢ Private Exclusive Collection                      â•‘
â•‘                                                                              â•‘
â•‘   Surpassing Masters â€¢ Museum Permanent Collection Standard                  â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`);

  log('Authenticating with Vertex AI...');
  let token = await getOAuthToken();
  log('âœ… OAuth token obtained\n');

  const results = { success: [], failed: [] };
  let consecutiveFailures = 0;

  for (let i = 0; i < REVEALS_VARIANTS.length; i++) {
    const variant = REVEALS_VARIANTS[i];
    const outputPath = path.join(OUTPUT_DIR, `meera_reveals_${variant.id}_${i}_${Date.now()}.png`);

    console.log('â•'.repeat(78));
    log(`âœ¨ [${i + 1}/${REVEALS_VARIANTS.length}] ${variant.name}`);

    const prompt = buildRevealsPrompt(variant, i);
    log(`   Declaration: ${NEXUS_DECLARATIONS[i % NEXUS_DECLARATIONS.length].slice(20, 70)}...`);
    log(`   Mood: ${variant.mood.slice(0, 50)}...`);

    try {
      const result = await generateImage(prompt, outputPath, token);
      log(`   âœ… MASTERWORK: ${path.basename(outputPath)} (${(result.size / 1024 / 1024).toFixed(2)} MB)`);
      results.success.push({ name: variant.name, path: outputPath, size: result.size });
      consecutiveFailures = 0;

      log(`   â³ Next in 25s...`);
      await sleep(25000);

    } catch (error) {
      log(`   âŒ Failed: ${error.message}`);
      results.failed.push({ name: variant.name, error: error.message });
      consecutiveFailures++;

      const waitTime = Math.min(120000 + (consecutiveFailures * 30000), 300000);
      log(`   â³ Adaptive wait: ${waitTime / 1000}s (failures: ${consecutiveFailures})`);
      await sleep(waitTime);
      log(`   â³ Next in 30s...`);
      await sleep(30000);
    }

    // Refresh token every 4 images
    if ((i + 1) % 4 === 0 && i < REVEALS_VARIANTS.length - 1) {
      log('ğŸ”„ Refreshing OAuth token...');
      token = await getOAuthToken();
    }
  }

  console.log(`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘              MEERA REVEALS GENERATION COMPLETE                               â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âœ… Masterworks Created: ${results.success.length}
  âŒ Failed: ${results.failed.length}
  ğŸ“Š Success Rate: ${((results.success.length / REVEALS_VARIANTS.length) * 100).toFixed(1)}%

  SUCCESSFUL MASTERWORKS:
${results.success.map(s => `     ğŸ“¸ ${s.name} (${(s.size / 1024 / 1024).toFixed(2)} MB)`).join('\n') || '     (none)'}

  FAILED:
${results.failed.map(f => `     âŒ ${f.name}`).join('\n') || '     (none)'}

  Output Directory: ${OUTPUT_DIR}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`);

  // Save manifest
  fs.writeFileSync(
    path.join(OUTPUT_DIR, 'manifest.json'),
    JSON.stringify({
      collection: 'Meera Reveals - Chiaroscuro Velvet Intimacy',
      results,
      timestamp: new Date().toISOString(),
      variants: REVEALS_VARIANTS.length
    }, null, 2)
  );
  log('ğŸ“‹ Manifest saved\n');
}

main().catch(console.error);
